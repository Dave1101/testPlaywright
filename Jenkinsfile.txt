pipeline { agent any
tools {

nodejs 'NodeJS'

}


stages {

stage('Checkout') {

steps {

checkout scm

}

}


stage('Install Dependencies') {

steps {

sh 'npm ci'

sh 'npx playwright install â€“with-deps'

}

}


stage('Run Tests') {

steps {

sh 'npm run test:ci'

}

}


stage('Publish Reports') {

steps {

junit 'test-results/*.xml'

publishHTML(target: [

reportDir: 'playwright-report',

reportFiles: 'index.html',

reportName: 'Playwright HTML Report'

])

}

}

}


post {

always {

archiveArtifacts artifacts: 'test-results/**/*, playwright-report/**/*, test-results/**/*.json', fingerprint: true

}

}

}